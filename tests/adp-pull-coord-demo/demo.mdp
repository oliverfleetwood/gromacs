title                   = OPLS Lysozyme NPT equilibration 
define                  = -DPOSRES  ; position restrain the protein
; Run parameters
integrator              = md        ; leap-frog integrator
nsteps                  = 50000     ; 2 * 50000 = 100 ps
dt                      = 0.002     ; 2 fs
; Output control
nstxout                 = 500       ; save coordinates every 1.0 ps
nstvout                 = 500       ; save velocities every 1.0 ps
nstenergy               = 500       ; save energies every 1.0 ps
nstlog                  = 500       ; update log file every 1.0 ps
; Bond parameters
continuation            = yes       ; Restarting after NVT 
constraint_algorithm    = lincs     ; holonomic constraints 
constraints             = h-bonds   ; bonds involving H are constrained
lincs_iter              = 1         ; accuracy of LINCS
lincs_order             = 4         ; also related to accuracy
; Nonbonded settings 
cutoff-scheme           = Verlet    ; Buffered neighbor searching
ns_type                 = grid      ; search neighboring grid cells
nstlist                 = 10        ; 20 fs, largely irrelevant with Verlet scheme
rcoulomb                = 1.0       ; short-range electrostatic cutoff (in nm)
rvdw                    = 1.0       ; short-range van der Waals cutoff (in nm)
DispCorr                = EnerPres  ; account for cut-off vdW scheme
; Electrostatics
coulombtype             = PME       ; Particle Mesh Ewald for long-range electrostatics
pme_order               = 4         ; cubic interpolation
fourierspacing          = 0.16      ; grid spacing for FFT
; Temperature coupling is on
tcoupl                  = V-rescale             ; modified Berendsen thermostat
tc-grps                 = Protein Non-Protein   ; two coupling groups - more accurate
tau_t                   = 0.1     0.1           ; time constant, in ps
ref_t                   = 300     300           ; reference temperature, one for each group, in K
; Pressure coupling is on
pcoupl                  = Parrinello-Rahman     ; Pressure coupling on in NPT
pcoupltype              = isotropic             ; uniform scaling of box vectors
tau_p                   = 2.0                   ; time constant, in ps
ref_p                   = 1.0                   ; reference pressure, in bar
compressibility         = 4.5e-5                ; isothermal compressibility of water, bar^-1
refcoord_scaling        = com
; Periodic boundary conditions
pbc                     = xyz       ; 3-D PBC
; Velocity generation
gen_vel                 = no        ; Velocity generation is off 

; Pull code, taken from Marko
pull_ncoords            = 3         ; phi and chi plus a meta coord which merges them to a single variable
pull                    = yes
pull_ngroups            = 5         ; three common and two unique groups
pull_group1_name        = C0
pull_group2_name        = N
pull_group3_name        = CA
pull_group4_name        = C
pull_group5_name        = N2
pull_coord1_type        = umbrella  ; harmonic potential
pull_coord1_geometry    = dihedral
pull_coord1_dim         = Y Y Y
pull_coord1_groups      = 1 2 2 3 3 4
pull_coord1_start       = yes       ; define initial COM distance > 0
pull_coord1_rate        = 0.001     ; 0.01 degrees per ps = 10 degrees per ns
pull_coord1_k           = 0.00      ; kJ mol^-1 rad^-2. Must be zero since the force is applied via the meta variable
pull_coord2_type        = umbrella  ; harmonic potential
pull_coord2_geometry    = dihedral
pull_coord2_dim         = Y Y Y
pull_coord2_groups      = 2 3 3 4 4 5
pull_coord2_start       = yes       ; define initial COM distance > 0
pull_coord2_rate        = 0.001     ; 0.01 degrees per ps = 10 degrees per ns
pull_coord2_k           = 0.00       ; kJ mol^-1 rad^-2

;here comes the meta variable
pull_coord3_type        = umbrella  ; harmonic potential
pull_coord3_geometry    = meta
pull_coord3_dim         = Y Y Y
pull_coord3_func		= (x1+x2)/2; new property that I made up
pull_coord3_start       = yes       ; define initial COM distance > 0
pull_coord3_rate        = 0.001     ; 0.01 degrees per ps = 10 degrees per ns
pull_coord3_k           = 0.001       ; kJ mol^-1 rad^-2




